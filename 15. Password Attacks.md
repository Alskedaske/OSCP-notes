# Attacking Network Services Logins

## SSH and RDP
Hydra
```bash
hydra -l <USERNAME> -P <PASSWORDLIST_PATH> -s <PORT> ssh://<TARGETIP>
```
We can find usernames by enumeration/information gathering techniques and by using built-in accounts such as root or Administrator

Password spraying: single password, many usernames

Once you have a password, TRY USING IT EVERYWHERE!!!

Hydra can help with this:
```bash
hydra -L /usr/share/wordlists/dirb/others/names.txt -p "<PASSWORD>" rdp://<TARGET_IP>
```

This can lead to accounts being locked out so do not blindly launch these tools.

## HTTP POST Login Form
Check the documentation of a web application to find default users. Then perform bruteforce on those users.

We need 2 pieces of info:
1. POST data itself
2. Failed login attempt (to differentiate between failure and success) -- condition string

Burp!

Now, we can use Hydra:
```bash
hydra -l <USERNAME> -P /usr/share/wordlists/rockyou.txt <TARGET_IP> http-post-form "<LOGINFORM_LOCATION>:<LOGIN_POST_DATA>:<CONDITION_STRING>"
```
Within the <LOGIN_POST_DATA> you need to specify the string to replace as `^PASS^`

For HTTP basic authentication (even if it is encoded in Burp), you can brute force using a user/password list
```bash
hydra -l admin -P rockyou.txt 192.168.191.201 http-get /
```

# Password Cracking Fundamentals
Cracking time = keyspace/hash rate
Keyspace = character set ^ amount of characters of password

To determine the hash for a string:
```bash
echo -n "<STRING>" | sha256sum
```
Example:
```bash
echo -n "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789" | wc -c
python3 -c "print(62**5)"
```
This gives you the keyspace for a 5 character password with a character set of 62

We can determine the hashrate using hashcat's benchmark mode
```bash
hashcat -b
```

Now we should have our hash rate! To calculate our cracking time, we can do keyspace/hash rate
```bash
python3 -c "print(<KEYSPACE_OUTPUT> / <HASHRATE>)"
```

This will give you the amount of seconds it will take to calculate all hashes in that keyspace, and therefore the time it will take to crack the password.

## Mutating Wordlists
Especially for password policies.

You can edit a wordlist using `sed`.

For example: remove all number sequencse (deletes all lines starting with 1 and doing editing in place with `-i`.
```bash
sed -i '/^1/d' demo.txt
```



```bash

```
```bash

```
```bash

```
```bash

```
```bash

```
```bash

```
