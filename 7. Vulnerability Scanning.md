## Vulnerability Scanning Theory

Can help establish baseline on the network before more thorough manual testing.

Basic process:
1. Host discovery
2. Port scanning
3. Operating system, service, and version detection
4. Matching the results to a vulnerability database

Types of vulnerability scans:
1. Internal
   - Usually VPN access. Sometimes on-site.
3. External
4. Unauthenticated
5. Authenticated

Key considerations that may need to be reflected in scan configurations:
1. Scanning duration
2. Target visibility: some targets may not be reachable due to firewalls/VPNs/etc. Also: presence of IPS, routers, etc. may influence this for an interal scan.
3. Rate limiting
4. Network and system impact of scan

## Nessus

Download Nessus: https://www.tenable.com/downloads/nessus

Verify:
```bash
cd ~/Downloads
echo "4987776fef98bb2a72515abc0529e90572778b1d7aeeb1939179ff1f4de1440d Nessus-10.5.0-debian10_amd64.deb" > sha256sum_nessus
sha256sum -c sha256sum_nessus
```
Install Nessus package
```bash
sudo apt install ./Nessus-10.5.0-debian10_amd64.deb
```
Start Nessus service
```bash
sudo systemctl start nessusd.service
```
Now it is hosted locally. Can be accessed on: https://127.0.0.1:8834
Sign up, register for Essentials

### Authenticated scan
Make sure **target** system is also configured correctly for accurate results! No firewall blocking, Antivirus exception/disabled. Windows: UAC (User Account Control). 

## Vulnerability Scanning with Nmap

Different categories of NSE scripts. Some important ones:
- Safe: no potential impact on stability
- Intrusive: might crash target service/system
- Vuln: check for vulnerability

All categories:
- auth
- broadcast
- brute
- default
- discovery
- dos
- exploit
- external
- fuzzer
- intrusive
- malware
- safe
- version
- vuln

 Always check and know implications!!

To look for `vuln` scripts:
```bash
cd /usr/share/nmap/scripts/
cat script.db  | grep "\"vuln\""
```

Useful: the `--script` option can take various inputs:
- Category: e.g. `--script "vuln"`
- Wildcards: e.g. `--script "http-*"` will run all scripts whose name starts with `http-`

This will **not** produce any useful output if -sV is not enabled!

### Working with (custom) NSE Scripts

E.g. specific CVE. Google CVE + NSE.
First: Download & save the script in the nmap scripting folder.
```bash
sudo cp /home/kali/Downloads/http-vuln-cve-2021-41773.nse /usr/share/nmap/scripts/http-vuln-cve2021-41773.nse
```

Second: Update `script.db`
```bash
sudo nmap --script-updatedb
```

Third: Use the script like normal, e.g.
```bash
sudo nmap -sV -p 443 --script "http-vuln-cve2021-41773" 192.168.50.124
```
```bash

```

```bash

```

```bash

```

```bash

```

```bash

```

